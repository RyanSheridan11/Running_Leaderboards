<div class="form-container">
  <h1>üèÉ Add New Run</h1>
  <p class="form-description">
    Track your latest 5k or Bronco (1.2k) run.
  </p>

  <%= form_with model: @run, url: runs_path, local: true, class: "run-form" do |form| %>
    <% if @run.errors.any? %>
      <div class="alert alert-error">
        <h4><%= pluralize(@run.errors.count, "error") %> prevented this run from being saved:</h4>
        <ul>
          <% @run.errors.full_messages.each do |msg| %>
            <li><%= msg %></li>
          <% end %>
        </ul>
      </div>
    <% end %>

    <div class="form-group">
      <%= form.label :race_type, "Race Type*" %>
      <%= form.select :race_type, [["5k", "5k"], ["Bronco (1.2k)", "bronco"]], { selected: "5k" }, { id: "race_type_select", class: "form-control" } %>
      <small class="form-text" id="race_type_help">Choose 5k or Bronco (1.2k)</small>
    </div>

    <div class="form-group">
      <%= form.label :date, "Date*" %>
      <%= form.date_field :date, value: Date.current, class: "form-control" %>
      <small class="form-text">Select the date of your run</small>
    </div>

    <div class="form-group">
      <%= form.label :time, "Time*", id: "time_label" %>
      <%= form.text_field :time, placeholder: "e.g. 25:30", id: "time_input", class: "form-control" %>
      <small class="form-text" id="time_help">Format: mm:ss for 5k, m:ss for Bronco</small>
    </div>

    <div class="form-actions">
      <%= form.submit "Add Run", class: "btn btn-primary" %>
      <%= link_to "Cancel", root_path, class: "btn btn-secondary" %>
    </div>
  <% end %>
</div>

<div class="submission-info">
  <h3>üìã Submission Guidelines</h3>
  <ul>
    <li>Ensure time is in the correct mm:ss or m:ss format.</li>
  </ul>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const raceTypeSelect = document.getElementById('race_type_select');
  const timeInput = document.getElementById('time_input');
  const timeHelp = document.getElementById('time_help');

  function updatePlaceholder() {
    if (raceTypeSelect.value === 'bronco') {
      timeInput.placeholder = 'e.g. 5:30';
      timeHelp.textContent = 'Format: m:ss for Bronco';
    } else {
      timeInput.placeholder = 'e.g. 25:30';
      timeHelp.textContent = 'Format: mm:ss for 5k';
    }
  }

  raceTypeSelect.addEventListener('change', updatePlaceholder);
  updatePlaceholder();
});
</script>
